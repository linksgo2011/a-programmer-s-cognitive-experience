# 第 2 章 软件工程中的逻辑学

破除诡辩的方法是系统的学习逻辑学，比较可惜的是学校教育中系统性的逻辑学课程已经很少见了。另外在软件工程中，很多人也并不重视逻辑学。

大多数有经验的开发者、系统分析师都具备一定的辩证思维和方法，要说谁没有逻辑，这件事情很难说得过去。如果每个人都是用自己的思维方式和 “逻辑”，让软件建模的统一语言非常困难。我疑惑的是每个人都相信逻辑是很重要的，但几乎没有文章讨论过软件设计和开发过程中如何使用现代逻辑学，以及解决几个诡辩的问题。

这里讨论几个能在软件工程中使用的逻辑学基础，尤其是业务分析、领域建模和架构设计中。公认的逻辑学之父是亚里士多德，但我们现在使用的逻辑学基础来源于弗雷格、黑格尔以及莱布尼茨等人的工作。

## 1. 理解概念

曾经参与一个物联网系统的模型设计，“设备” 这个词在不同的开发者眼里有不同的概念，为此，讨论 “设备” 这个词花费了不少的功夫，最终依然没有怎么定义清楚。

有些开发者认为“设备”是现实中看得见摸得着的物品，另外的开发者将服务器上用于映射物理设备的实例，也叫做“设备”。于是，他们在沟通和建模时非常混乱。

另外一个例子是“用户”这个概念。

在不同的场景（上下文）下，“用户”这个概念可以是使用软件的大活人，也可以是数据库中的一条记录，也可以是服务中的用户对象，有时候也将用户服务叫做用户。

这样就非常混乱，不仅无法交流和沟通，而且开发者对系统的认知也变得困难，很多东西处于混沌状态。

在咨询的工作中，我发现非常有意思的是，将软件中的概念一一定义清楚，整个系统的设计工作差不多就完成了。所以设计软件的过程和现实中人们相互交流非常类似。英国哲学家维特根斯坦把人们交流的过程叫做“语言的游戏”，当我们描述事物的时候实际上就是将有清晰边界的元素贴上标签，这个标签就是我们说的概念。

朴素的概念是来源于个人背景和理解，因此概念难以统一。正是于此翻译也不太可能[^6]，不同文化背景难以找到合适的概念互相映射。后来哲学家认识到人们认识概念是由一些更为基础的属性构成的，那可以认为概念就是由属性组成的。比如 “人” 这个概念，属性有四肢、直立行走的行为、皮肤光滑等属性。

这些基本的属性又是一些更基本的概念，如果我们对这些基本的概念达成共识，那么我们就有机会对概念进行统一。类似于面向对象语言中的类，类有各种属性，这些属性最终都可以通过 8 种基本的数据结构描述。

因此属性是认识概念非常重要的一方面。属性包含了事物自身的性质、行为，比如黑白、高矮，是否能飞行，是否独立行走。事物除了自身的性质外，还与其他事物发生一定的关系，比如大于、相等、对称、属于等。事物的性质、行为以及和其他事物的关系，统称为事物的属性。

**通过属性就能找到概念的边界。** 具有相同属性的概念是同一个概念，即使是叫法不同也不应该分为不同的概念。比如土豆、马铃薯，一旦属性的增加和移除都算作不同的概念，比如小土豆是土豆吗？通过属性就就能发现生活中的命名谬误，比如小熊猫并不是小的熊猫，而是单独的一种动物。

## 2. 形式语言和非形式语言

概念只是我们对所认识的事物起的一个名字，词语是概念的自然语言形式，概念是词语的思想内容。

一个概念可以具有多种表达方法，对于软件设计来说，我们可以用自然语言描述概念。也可以通过定义一个类来描述，并在程序运行时实例化这个概念。通过数学或者数理逻辑，我们可以使用集合来描述一个概念。

比如 “商品” 这个概念，可以通过不同的方法表达。

自然语言中，商品是指可以通过货币或者其他物品交易的物品，可以是自然实体，也可以是虚拟物品。这是社会经济中对商品的描述，商品具有一个核心属性就是价格，有价格意味着可以交易。

自然语言中，概念和词语之间并不是一一对应的，这是需要日常特别注意的。

1. 自然语言中，任何概念都必须通过词语来表达，但不是所有的词语都表达概念。在语言中，基本上都会将词分为虚词和实词两大类，只有实词（注意不是名词）可以表达概念。
2. 同一个概念可以由不同的词语表达，比如前面提到的土豆、马铃薯。
3. 一个词在不同的的情况下（上下文），可以用来表达几个不同的概念，多义词就是这样，同一个词表达不同的概念，叫做这个词的词项。

自然语言（Natural Language）就是人类讲的语言，它是自然人类发展中自然形成的，比如汉语、英语。

这类语言不是经过特别设计的，而是通过自然进化的。它的特点是**语法规则只是一种规律，并非需要严格遵守**，这种语言含有大量的推测，以及对话者本身的认知背景（比如东西方不同）。认知背景赋予了词汇、概念的不同含义，比如，豆腐脑这个词，不说东西方差异，就是国内南北都会有争议。

正因为如此，才会产生大量的诡辩，让交流效率降低。

于是产生了形式语言，形式语言（Formal Language）是用符号代替自然概念的语言。例如数学家用的数字和运算符号、化学家用的分子式等，以及编程语言中的一些符号（Token）。计算机编程也是一种形式语言，是专门用来表达计算过程的形式语言，来操作的计算机。

形式语言需要严格遵守语法规则，例如 1+1=2 是数学中一种形式语言，

形式语言来源于形式逻辑，特别是形式逻辑中的符号逻辑。亚里士多德的《工具论》为形式逻辑奠定了基础，中国古代的周易的卦爻可以看做一种形式逻辑，而也是后来很多人牵强附会将计算机的起源和二进制关联到周易上。虽然中国古代有了形式逻辑的朴素思想，但是遗憾的是没有脱离朴素的辩证法。中国古代哲学也有更有价值的内容，这一点不应该出于民族情绪特别粉饰。

形式逻辑的含义用一句话表述为：用一套特别的（形式的含义）、显示的规则来约束逻辑推理规则。

由于形式逻辑也在不断演化，现代形式逻辑和古希腊也不太一样。19 世纪以前的形式逻辑主要是传统逻辑，19 世纪中叶以后发展起来的现代形式逻辑，通常称为数理逻辑，也称为符号逻辑。

莱布尼兹倡导建立“普遍的符号语言”，通过推理演算和机械化的思想一步一步严谨的完成逻辑推理。如果需要建立符号推理系统，就需要定义符号、推理规则作为系统的要素。

弗雷格完成了《概念语言》一书建立了一个初步的逻辑体系（一阶逻辑体系），通过概念系统来消除二义性，避免偷换概念，并通过推理结构来完成严格的推理。

这个时候的概念依然是通过定义完成的，直到康托尔创立了集合论，通过集合来描述概念，集合中的元素就是概念的内涵，集合能被用到的地方就是外延。

集合论的建立，标志现代形式逻辑的建立，也就是符号逻辑。

实际上，弗雷格建立的一阶逻辑体系可以看做一套逻辑体系模板，用它可以拓展出更多的逻辑体系，在人们认识到概率前，认为逻辑推理确定的，当引入概率后就不行了，因此哲学家们有发展出来概率归纳逻辑。

总之知道形式语言和自然语言之间的区别，可以避免无意义的争论。软件工程师就是一个对现实业务形式化的工作岗位，将需求这种自然语言转变为代码这种形式语言。

正因为如此，需求和沟通的矛盾不可能避免，除非提出需求的人也是用形式语言，那么软件工程师的价值也就没有了。

使用形式语言可以精确的定义一个概念，并使用精确的语义规则和计算机沟通，这就是软件工程师编写软件的过程。

如果通过计算机语言来描述一个概念，其实就是面向对象中的一个类，这里定义商品有两个属性名称和价格：

```java
public class Goods {
  private String name;
  private int price;
}
```

如果用集合的枚举法来表述就是商品就是：

```
Goods{name,price}
```

计算机语言和数学语言是一种形式化的语言，是可以精确的描述一个概念，但是自然语言只能通过模糊的给出概念的描述。自然语言翻译成计算机语言的不确定性，带来了无休无止的争吵，但这也是软件设计者的主要工作。

## 3.概念的外延

正是因为自然语言的这种模糊性，为了更加具体的描述一个概念。哲学上概念的共识是概念有两个基本的逻辑特征，即内涵和外延。概念反应对象的特有属性或者本质属性，同时也反映了具有这种特有属性或者本质属性的对象，因而概念有表达属性的范围。

- 概念的内涵是指反映在概念中的对象特有属性或本质属性。
- 概念的外延是指具有这些属性的所有对象，即囊括对象的范围。

例如商品这个概念的内涵是 “能进行交换的商品”，本质属性是能进行交换，从本质上区别产品。它的外延就是投入市场能卖的所有事物。

对概念的外延的清晰描述对我们设计软件产品的定位非常有帮助，我们购买软件服务无非两种情况，生活娱乐使用，或者工作使用。马克思社会经济学精妙的描述为生产资料、生活资料。这其中的逻辑完全不同，按照生活资料的逻辑设计一款生产资料的产品注定要走弯路。

概念的内涵和外延在一定条件下或者上下文中被确定的，这取决于参与人的共识。严格锁定概念的内涵和外延，不能帮助我们讨论问题和改进软件模型。随意修改内涵和外延这是典型的偷换概念和诡辩。

概念的内涵和外延是一个此消彼长的兄弟。当内涵扩大时，外延就会缩小，概念就会变得越具体。当内涵缩小时，外延就会扩大，反映的事物就会越多。

在面向对象软件建模中的影响非常明显。对象特有属性或者本质属性越少，那么这个对象能被复用的场景越多，也就是内涵越小。反之，特有属性越多，能被复用的情况就越少了。软件建模过程中随意修改概念往往意识不到，但是每一次属性的添加和移除都带来概念的内涵和外延发生变化。

非常典型的一个例子发生在订单模型中。一般来说，我们会把支付单和订单分开设计，订单的概念中没有支付这个行为，但有时候觉得支付单的存在过于复杂，会将支付单的属性放到订单中，这个时候订单的内涵和外延变了。

内涵和外延发生变化但是设计人员没有意识到，会使用同一个词语。一旦使用同一个词语就会产生二义性，二义性的存在对软件建模是致命性打击。比如用户维护的地址、地址库中的地址、订单中的地址，这三个 ”地址“ 虽然名字相同，但是内涵和外延不同。

意识不到概念的内涵和外延，是无法设计好逻辑良好的软件模型的。

## 4. 定义概念的方法

变量命名和缓存失效是编程中最让人头疼的两件事。

变量命名其实就是在给一个概念下定义。定义是揭示概念的内涵和外延的逻辑方法，一个准确的定义需要反映出对象的本质属性或特有属性。下定义困难普遍有两个痛点：

1. 不懂好的下定义的逻辑方法。
2. 对业务概念或者领域不熟悉。

对于第一个痛点，根据概念的属性、内涵和外延，逻辑学中有一些很好地下定义方法。

**属加种差定义法。**这种下定义的方法通俗来说就是先把某一个概念放到另一个更广泛的概念中，逻辑学中将这个大的概念叫做 ”属概念“，小的概念叫做 ”种概念“。从这个属概念中找到一个相邻的种概念，进行比较，找出差异化本质属性，就是”种差“。比如，对数学的定义，数学首先是一种科学，和物理学处于同类，它的本质属性是研究空间形式和数量关系。于是可以得到数学这个概念定义：数学是一种研究现实世界的空间形式和数量关系的科学。

用这种方法给订单、支付单、物流单下一个定义：

- 订单是一种反映用户对商品购买行为的凭据。属概念是”凭据“，种差是”反映用户对商品购买行为“。
- 支付单是一种反映用户完成某一次支付行为的凭据。属概念是”凭据“，种差是”用户完成某一次支付行为“。
- 物流单是一种反映管理员完成某一次发货行为的凭据。属概念是”凭据“，种差是”管理员完成某一次发货行为“。

在逻辑中可以参考下面的公式：

> 被定义的概念 = 种差 + 属概念

对于第二个痛点，这不是软件建模能解决的问题，需要充分和领域专家讨论，获取足够的业务知识。人们对概念的定义或者认识是随着对事物的认识不断加深而变化的。一个完全对某个领域没有基本认识的软件工程师很难做出合理的软件建模，例如银行、交易所、财会等领域的软件需要大量的行业知识。

我们做消费者业务的互联网开发时，往往因为和我们的生活相关，所以这种感受并不明显。当做行业软件时，领域知识对软件模型的影响甚至是决定性的。

## 5. 同一律、矛盾律、排中律

概念只是语言的元素，如果需要建立逻辑思维，还需要一些逻辑规律。逻辑学的三个基本规律可以让沟通更加准确，避免无意义的争论，减少逻辑矛盾，让讨论有所产出。这三个重要的规律是：同一律、矛盾率、排中律。

##### 1. 同一律

在同一段论述（命题和推理）中使用的概念含义不变，这个规律就是同一律。形式化的表述是 A -> A。

”概念“在逻辑学中的意义非常重要，概念有两个逻辑学规律：内涵和外延。内涵指的是这个概念区别于其他概念的本质属性，例如大熊猫是指的生物学中某一个物种。外延指的是这个概念所能描述的事物的范围，比如白马比马这个概念外延要小，是不同的两个概念。

所以白马非马的本质争论在于自然语言的不确定性：

- 从概念上说，白马这个概念不是马这个概念。所以白马非马。
- 从谓词（”是“ 这个谓词）逻辑来说，白马这个概念代表的事物集合属于马这个概念代表的事物集合。所以白马是马（白马属于马，但是白马这个概念不是马这个概念）。

同一律描述的是在一段论述中，需要保持概念的稳定，否则会带来谬误。我在大学辩论赛中利用了这个规律，赢了一次辩论。

当时的论题是”网络会让人的生活更美好吗？“，两个论点主要的论点是：

- 网络让人们的生活更方便。
- 网络让人们沉溺虚拟世界。

我们选择的论点是 ”网络让人们的生活更方便“。在辩论赛的前期，另外一方为了论证 ”网络让人们沉溺虚拟世界“，描述了打电话、写信也可以让人生活很美好，并不会沉溺。这刚好落入了我们的逻辑陷阱。我们指出，邮政、电话网络也是网络的一种，对方的逻辑不攻自破。

这属于典型的 ”偷换概念“，我们偷换了“计算机网络”和“网络”这几个概念。

##### 2. 矛盾律

矛盾律应用的更为普遍，几乎所有人都能认识到矛盾律。它的含义是，在一段论述中，互相否定的思想不能同时为真。形式化的描述是： ”A 不能是非 A“。

矛盾律这个词的来源就是很有名的 ”矛和盾“ 的典故，出自《韩非子·难势》中。说有一个楚人卖矛和盾，牛皮吹的过大，说自己的盾在天底下没有矛能刺破，然后又说自己的矛，天底下的盾是不能穿透的。前后矛盾是一个众所周知的逻辑规律，但是并不是一开始马上就能看出来，需要多推理几步才能看出来。即使如此，在同一个上下文中，出现了矛盾的逻辑论述也被认为是不可信的。

具有矛盾的论述有时候又被称为悖论。尤其是宗教领域充满了大量的悖论，例如是否存在一个万能的神，做一件自己不能完成的事情。

矛盾律的用处可以驳斥不合理的论断，也可以用于反证法。在软件开发过程中，我们时常遇到这种情况，需要开发过程中才能发现矛盾。这个很难避免，除非有充足经验的工程师。

需要注意的是逻辑学中的矛盾律和毛泽东思想中的矛盾论不是一回事，前者是逻辑学规律，后者是辨证唯物的一种方法。

##### 3. 排中律

排中律是逻辑规律中最难理解的一个规律。它的表述是：同一个思维过程中，两个互相否定的思想必然有一个是真的。用形式化的表述就是，A 或者非 A。

排中律的意义在于，明确分析问题的时候不能含糊其辞，从中骑墙。比如有人讨论：人是不是动物。不能最终得到一个人既是动物又不是动物，这种讨论是没有意义的。

比如在一次技术会议中，需要选择使用的数据库，只能使用一种数据库。如果采用了 MySQL 就不能说没有采用 MySQL。

排中律看起来好像没有意义，但具有非常大的价值，让讨论最终有结论，而不是处于似是而非的中间状态。

## 3. 诡辩

在沟通中，人们会下意识的引入谬误，从而主动或者被动的诡辩。诡辩的方法非常多，下面是常见的几种诡辩方法，认识到诡辩的存在，让讨论的输出更可信。

##### 1. 偷换概念

偷换概念是一种利用同一律的诡辩方法。往往是利用一个词语的多义性来制造诡辩，这种例子相当常见，再一次日常对话中：

> 朋友：为了让自己的判断和认知更为客观，我们应该同时学习多个学科的东西。
>
> 我（故意抬杠）：人不能同时学习多个学科的东西。
>
> 朋友：为什么，学生不都是同时学习数学、语文、英语么。
>
> 我：你现在正在看手上这本书，能同时看我手上这本么。
>
> 朋友：。。。（感觉被套路）

我偷换了概念，把 ”同时“ 这个词的时间精度调低了，导致这次对话变了味。

偷换概念在生活中无处不在。《武林外传》

中的秀才利用 ”我“这个概念的偷换，让姬无命莫名其妙并自杀了。

##### 2. 相关性不等于因果性

最经典的例子是，很多父母信佛，然后娃高考的时候天天去求神问佛。如果小孩考上了大学，那么就是拜佛的功劳，如果没有考上，那就是小孩不努力。多么完美的逻辑闭环，完全无懈可击。

同样的桥段在各种电视、电影中存在。某一伙人闯入了一个村子，然后这个村子发生了瘟疫，群众认为是这些人带来了不详。

程序员圈子也会有类似的议论，因为大公司都用的 Java 而不是 PHP，所以 PHP 是一个垃圾语言，我们要成为大公司，所以要把 PHP 换成 java。所以很多公司明明可以苟一下，然后因为折腾死掉了。

我们需要时刻记住，相关性不等于因果性，才能认识到一些微妙的逻辑关系。

##### 3. 因果倒置

“可怜之人必有可恨之处。” 这是很多人挂到嘴边的话，支持者甚多。

我小的时候对这句话记忆深刻。小学的时候被年长的同学欺负，后来因为打架老师知道了，其他同学都表明我是个被欺负的可怜鬼，老师还是对我们都做出同样的处罚。

说出了一句举世名言：“为什么欺负你，不欺负别人”。

为什么只欺负你，不欺负别人，所以你也不对，同样要受到惩罚。这是典型的强盗逻辑，从结果推导出原因，但是这个原因并不成立，因为我们知道原命题为真，逆命题不一定为真。

##### 5. 归纳法的局限

逻辑学上把个别的知识推广到一般的知识规律叫做归纳推理。归纳推理是一种朴素的认识方法，在逻辑学中，归纳推理有其意义，但是需要注意的是逻辑学从来没有把归纳法得出的结论当做真理。

归纳法的问题和类比谬误类似。古人认识的到了一个规律，鸡叫三遍天会亮，但是后来出去旅游发现其他地方的鸡不是这样的，真的是应了那句，“东方不亮西方亮，黑了南方有北方。”

中国太大了，甚至二十四节气的规律都不能适用于每一个地方。归纳法只能有限的反应某种规律，不能广泛、绝对的得到真理，也不能从个体推出一般。

算命先生希望从四柱八字、面相分析、掌纹、笔迹这些中归纳真理，如果认识到归纳法的局限性，就不会平白无故交这些智商税了。

##### 6. 责任转移

证明神存不存在，保健品有没有功效，壮阳药有没啥作用是科学界三大难题。

从逻辑上证明有其实很容易，只需要找出一个例子即可，比如证明天鹅是白色的，只需要找出一个白色的天鹅即可。但是证明黑色的天鹅不存在，是非常困难的，除非穷举世界上所有的天鹅，才能得出这个结论。

人们的思维中，天生偷懒，所以人们才会有 “宁可信其有，不可信其无”。

所以有一种诡辩，我姑且称之为责任转移，就是在辩论中把举证的责任推给别人，然后再来挑对方的毛病。这是一种非常高级且隐晦的诡辩手段。

比如有神论要求无神论者给出证据，证明神不存在，但是证明无非常困难。对方只能举出一些例子，但是这些例子非常脆弱，如果再结合偷换概念就更无懈可击了。

> 大师：神会保佑你的。
>
> 无神论者：神不存在。
>
> 大师：你怎么证明神不存在呢。
>
> 无神论者：我从来没看到过神。
>
> 大师：没看到过神，不代表神不存在。
>
> 无神论者：看都没看见，怎么能说神存在呢。
>
> 大师：神是一种信念，它无处不在，慢慢体悟吧。
>
> 无神论者：。。。

责任转移大法是不断把举证的责任推给对方，然后在挑错，让对方自顾不暇。

## 6. 逻辑工具：概念图